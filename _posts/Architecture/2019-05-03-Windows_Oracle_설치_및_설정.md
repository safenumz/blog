---
layout: post
title: '[Oracle] Windows Oracle 설치 및 설정'
category: Architecture
tags: [sql, windows, oracle]
comments: true
---

# Environment
- Windows 10
- Oracle 11.1.0

# Oracle 설치
- Oracle 홈페이지에서 다운받은 후 GUI로 설치 가능


# Oracle 기본 설정
## hr 계정 unlock 하기

~~~sql
SQL> conn sys/as sysdba
SQL> alter user hr account unlock;

-- 사용자(hr)가 소유한 모든 테이블 보기
SQL> select table_name from user_tables;

-- employees 테이블의 컬럼 정보 보기
SQL> desc employees;

-- 사용자 보기
SQL> show user;

-- 전체 사용자 정보 보기(sys계정으로 접속해야 함)
SQL> select username, default_tablespace from dba_users;

-- hr 계정으로 sysdba에 접속
SQL> conn hr/as sysdba
~~~

## scott 계정 생성

~~~sql
SQL> create user scott identified by tiger

SQL> default tablespace user
SQL> temporary tablespace temp;

-- 사용자를 삭제하는 법
SQL> drop user scott;

-- scott 사용자에게 권한부여
SQL> grant connect, resource to scott;

-- scott 계정에 샘플데이터 생성법
-- scott 내 테이블 목록확인
SQL> select * from tab;

-- scott에 학습용 오브젝트 일괄 생성

SQL> conn /as sysdba
SQL> @C:\oraclexe\app\oracle\product\11.2.0\server\rdbms\admin\scott.sql;

-- @-실행하라(뒷내용을[scott.sql]). system유저 상태에서 실행할것
-- 실행하면 scott유저로 자동접속이 되어있음(show user;->"SCOTT")

SQL> select * from tab;

-- 실행후 scott 유저로 접속 안될 시 비밀번호 변경하면 접속가능
SQL> select username from all_users;
SQL> user scott identified by tiger;

SQL> desc tab;
SQL> select tname from tab;

-- scott 정보 조회하기
-- emp 테이블에 있는 컬럼 정보 조회
SQL> desc emp;

-- 사원 정보 조회
SQL> select * from emp;

-- 사원명만 조회
SQL> select ename from emp;
~~~

# Oracle DB 외부접속
- C://app/product/11.1.0/db_1/network/ADMIN/

## 방화벽 열어주기
- 제어판 > Windows Defender 방화벽 > 고급설정 > 인바운드 규칙 > 새규칙
- 프로그램 설정 > 다른 프로그램 경로 > 찾아보기 > mysqld.exe 등록
- 예) C://Program Files/MySQL/MySQL Server 5.7/bin/mysqld.exe

## hosts 파일 수정
- 개인 DNS 서비스 역할을 하며, 특정 도메인/IP 차단 역할 및 개인 IP 등록 역할을 함
- Windows : C://windows/system32/drivers/etc/hosts
- Linux : /etc/hosts
- 예) 192.188.0.1 ora11g 구문을 추가하고 웹브라우저에 ora11g를 치면 자동으로 192.168.0.1로 연결됨

## listener.ora
- 클라이언트가 오라클 서버에 접속하기 위해서 서버 컴퓨터에 하는 설정
- C:\app\a\product\11.2.0\dbhome_1\NETWORK\ADMIN

~~~shell
[oracle@ora11g admin]$ cat listener.ora

# listener.ora Network Configuration File: /u01/app/oracle/product/11.2.0/dbhome_1/network/admin/listener.ora

# Generated by Oracle configuration tools.

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = ora11g)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )

ADR_BASE_LISTENER = /u01/app/oracle
~~~

## tnsnames.ora
- 클라이언트에서 오라클 서버로 접속할 때 필요한 프로토콜 및 포트번호, 서버주소, 인스턴스를 설정해 주는 파일

~~~sql
ORACLR_CONNECTION_DATA =                                                        
  (DESCRIPTION =                                                                
    (ADDRESS_LIST =                                                             
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))                           
    )                                                                           
    (CONNECT_DATA =                                                             
      (SID = ORCL)                                                              
      (PRESENTATION = RO)                                                       
    )                                                                           
  )                                                                             
                                                                                
ORCL =                                                                          
  (DESCRIPTION =                                                                
    (ADDRESS = (PROTOCOL = TCP)(HOST = ora11g)(PORT = 1521))                    
    (CONNECT_DATA =                                                             
      (SERVICE_NAME = ORCL)                                                     
    )                                                                           
  )                                                                             
~~~

## sqlnet.ora
- 클라이언트가 오라클 서버로의 접속 방식을 설정하는 파일 (수정하지 않음)
- 시도만 해봄

~~~shell
#SQLNET.AUTHENTICATION_SERVICES=(NTS)
SQLNET.AUTHENTICATION_SERVICES=(NONE)
sqlnet.CONNECT_TIMEOUT = 0
~~~

## services.msc
- OracleOraHome92TNSListener가 시작되었는지 확인

~~~shell
$ tnsping <외부ip주소>

$ ping ora11g
~~~

~~~shell
# tnslistener 상태확인
$ lsnrctl status 

# tnslistener 시작
$ lsnrctl start

# tnslistener 중지
$ lsnrctl stop

# tnslistener 재시작
$ lsnrctl reload
~~~

## 테스트

~~~sql
select * from emp;

select * from dept;

-- hr 계정 접속
conn hr/hr

select * from employees;

select * from departments;
~~~
